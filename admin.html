<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SDT | Genel YÃ¶netim Merkezi</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Source+Serif+4:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root { --ink: #0e0e14; --gold: #c9a84c; --crimson: #8b1a2b; --parchment: #f5f0e8; --panel-bg: #121218; }
  * { box-sizing: border-box; font-family: 'Source Serif 4', serif; }
  body { background: var(--ink); color: var(--parchment); margin: 0; min-height: 100vh; display: flex; flex-direction: column; }
  
  /* GÄ°RÄ°Å EKRANI */
  #login-screen { position: fixed; inset: 0; background: var(--ink); display: flex; align-items: center; justify-content: center; z-index: 999; }
  .login-box { background: rgba(255,255,255,0.03); padding: 40px; border: 1px solid var(--gold); border-top: 4px solid var(--gold); width: 100%; max-width: 360px; text-align: center; }
  
  /* PANEL DÃœZENÄ° */
  #admin-panel { display: none; grid-template-columns: 250px 1fr; min-height: 100vh; }
  .sidebar { background: #08080a; border-right: 1px solid #222; padding: 20px; display: flex; flex-direction: column; position:sticky; top:0; height:100vh; }
  .main-content { padding: 40px; overflow-y: auto; background: var(--panel-bg); }

  /* MENÃœ BUTONLARI */
  .brand { font-family: 'Playfair Display', serif; color: var(--gold); font-size: 22px; margin-bottom: 40px; text-align: center; border-bottom: 1px solid #333; padding-bottom: 20px; }
  .nav-btn { 
    background: transparent; border: none; color: #888; text-align: left; padding: 15px; width: 100%;
    margin-bottom: 5px; cursor: pointer; transition: all 0.2s; border-radius: 4px; font-size: 15px; display: flex; align-items: center; gap: 10px;
  }
  .nav-btn:hover { background: rgba(255,255,255,0.05); color: var(--parchment); }
  .nav-btn.active { background: rgba(201,168,76,0.15); color: var(--gold); border-left: 4px solid var(--gold); }
  .logout-btn { margin-top: auto; background: #1a1a20; color: #aaa; border: 1px solid #333; }

  /* Ä°Ã‡ERÄ°K ALANLARI */
  .content-section { display: none; animation: fadeIn 0.3s; }
  .content-section.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 15px; }
  .section-title { font-family: 'Playfair Display', serif; font-size: 28px; color: var(--gold); margin: 0; }

  /* KARTLAR & FORMLAR */
  .card { background: rgba(255,255,255,0.02); border: 1px solid #2a2a35; padding: 25px; margin-bottom: 20px; border-radius: 6px; }
  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  .form-full { grid-column: 1 / -1; }
  
  label { display: block; font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 8px; }
  input, textarea, select { 
    width: 100%; background: #1a1a20; border: 1px solid #333; color: var(--parchment); padding: 12px; 
    font-size: 14px; border-radius: 4px; outline: none; transition: border 0.2s;
  }
  input:focus, textarea:focus { border-color: var(--gold); }
  
  .btn-primary { background: var(--gold); color: var(--ink); border: none; padding: 12px 24px; font-weight: bold; cursor: pointer; border-radius: 4px; }
  .btn-primary:hover { background: #e2c97e; }
  
  /* LÄ°STE GÃ–RÃœMÃœ */
  .data-list { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
  .data-item { 
    background: #15151b; padding: 15px; border-radius: 4px; border-left: 3px solid #333; 
    display: flex; justify-content: space-between; align-items: center; transition: all 0.2s;
  }
  .data-item:hover { border-left-color: var(--gold); background: #1a1a22; }
  .data-info h4 { margin: 0 0 5px 0; color: var(--parchment); font-size: 16px; }
  .data-info p { margin: 0; font-size: 13px; color: #777; }
  .btn-delete { background: rgba(139,26,43,0.2); color: #ff4757; border: 1px solid rgba(139,26,43,0.3); padding: 6px 12px; cursor: pointer; border-radius: 4px; font-size: 12px; }
  .btn-delete:hover { background: var(--crimson); color: white; }

  /* RESPONSIVE */
  @media (max-width: 768px) { #admin-panel { grid-template-columns: 1fr; } .sidebar { display: none; } }
</style>
</head>
<body>

<div id="login-screen">
  <div class="login-box">
    <div style="font-size:40px; color:var(--gold); margin-bottom:10px;">Î£</div>
    <h2 style="margin:0 0 20px 0;">YÃ–NETÄ°M PANELÄ°</h2>
    <input type="email" id="email" placeholder="E-Posta" style="margin-bottom:10px;">
    <input type="password" id="password" placeholder="Åifre" style="margin-bottom:20px;">
    <button onclick="login()" class="btn-primary" style="width:100%">GÄ°RÄ°Å YAP</button>
    <p id="login-msg" style="color:var(--crimson); font-size:12px; margin-top:15px;"></p>
  </div>
</div>

<div id="admin-panel">
  <aside class="sidebar">
    <div class="brand">SDT YÃ¶netim</div>
    <button class="nav-btn active" onclick="showSection('ayarlar')">âš™ï¸ Site AyarlarÄ±</button>
    <button class="nav-btn" onclick="showSection('duyurular')">ğŸ“¢ Duyurular</button>
    <button class="nav-btn" onclick="showSection('etkinlikler')">ğŸ“… Etkinlikler</button>
    <button class="nav-btn" onclick="showSection('galeri')">ğŸ“· Galeri</button>
    <button class="nav-btn" onclick="showSection('basvurular')">ğŸ“ BaÅŸvurular</button>
    <button class="logout-btn nav-btn" onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
  </aside>

  <main class="main-content">
    
    <section id="sec-ayarlar" class="content-section active">
      <div class="section-header">
        <h2 class="section-title">Site Genel AyarlarÄ±</h2>
        <small style="color:#666">Ana sayfadaki metinleri buradan dÃ¼zenleyin.</small>
      </div>
      <div class="card">
        <div class="form-grid">
          <div class="form-full">
            <label>Ana ManÅŸet (Hero BaÅŸlÄ±k)</label>
            <input type="text" id="set-hero-title" placeholder="Ã–rn: Siyasal DÃ¼ÅŸÃ¼nceler">
          </div>
          <div class="form-full">
            <label>Alt BaÅŸlÄ±k (Slogan)</label>
            <input type="text" id="set-hero-sub" placeholder="Ã–rn: Fikirlerin Ã§arpÄ±ÅŸtÄ±ÄŸÄ± platform...">
          </div>
          <div class="form-full">
            <label>HakkÄ±mÄ±zda YazÄ±sÄ±</label>
            <textarea id="set-about" rows="6" placeholder="TopluluÄŸumuz 2023 yÄ±lÄ±nda..."></textarea>
          </div>
        </div>
        <br>
        <button class="btn-primary" onclick="saveSettings()">AYARLARI KAYDET</button>
      </div>
    </section>

    <section id="sec-duyurular" class="content-section">
      <div class="section-header"><h2 class="section-title">Duyuru YÃ¶netimi</h2></div>
      
      <div class="card">
        <h3>Yeni Duyuru Ekle</h3>
        <div class="form-grid">
          <input type="text" id="d-baslik" placeholder="Duyuru BaÅŸlÄ±ÄŸÄ±">
          <select id="d-etiket">
            <option value="Yeni">Etiket: Yeni</option>
            <option value="Etkinlik">Etiket: Etkinlik</option>
            <option value="Genel">Etiket: Genel</option>
          </select>
          <textarea id="d-icerik" class="form-full" placeholder="Duyuru iÃ§eriÄŸi..."></textarea>
        </div>
        <br>
        <button class="btn-primary" onclick="addDuyuru()">DUYURU YAYINLA</button>
      </div>

      <h3>YayÄ±ndaki Duyurular</h3>
      <div id="list-duyurular" class="data-list">YÃ¼kleniyor...</div>
    </section>

    <section id="sec-etkinlikler" class="content-section">
      <div class="section-header"><h2 class="section-title">Etkinlik YÃ¶netimi</h2></div>
      
      <div class="card">
        <h3>Yeni Etkinlik Ekle</h3>
        <div class="form-grid">
          <input type="text" id="e-baslik" placeholder="Etkinlik AdÄ±" class="form-full">
          <input type="date" id="e-tarih">
          <input type="text" id="e-konum" placeholder="Konum / Platform">
          <textarea id="e-aciklama" class="form-full" placeholder="KÄ±sa aÃ§Ä±klama..."></textarea>
        </div>
        <br>
        <button class="btn-primary" onclick="addEtkinlik()">ETKÄ°NLÄ°ÄÄ° PLANLA</button>
      </div>

      <h3>Planlanan Etkinlikler</h3>
      <div id="list-etkinlikler" class="data-list">YÃ¼kleniyor...</div>
    </section>

    <section id="sec-galeri" class="content-section">
      <div class="section-header"><h2 class="section-title">Galeri YÃ¶netimi</h2></div>
      
      <div class="card">
        <h3>FotoÄŸraf Ekle</h3>
        <div class="form-grid">
          <input type="text" id="g-url" placeholder="FotoÄŸraf URL (Ã–rn: assets/img.jpg)" class="form-full">
          <input type="text" id="g-desc" placeholder="AÃ§Ä±klama (Ã–rn: 2024 KonferansÄ±)" class="form-full">
        </div>
        <br>
        <button class="btn-primary" onclick="addGaleri()">FOTOÄRAF EKLE</button>
      </div>

      <h3>Galerideki FotoÄŸraflar</h3>
      <div id="list-galeri" class="data-list">YÃ¼kleniyor...</div>
    </section>

    <section id="sec-basvurular" class="content-section">
      <div class="section-header"><h2 class="section-title">Ãœye BaÅŸvurularÄ±</h2></div>
      <div id="list-basvurular" class="data-list">YÃ¼kleniyor...</div>
    </section>

  </main>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, doc, deleteDoc, query, orderBy, onSnapshot, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  // âœ… FIREBASE CONFIG ENTegre EDÄ°LDÄ° âœ…
  const firebaseConfig = {
    apiKey: "AIzaSyDPLsa0Vstirz25FU4JAp5oUcTHJXcOM5I",
    authDomain: "siyasal-dusunceler-toplulugu.firebaseapp.com",
    projectId: "siyasal-dusunceler-toplulugu",
    storageBucket: "siyasal-dusunceler-toplulugu.firebasestorage.app",
    messagingSenderId: "739243257292",
    appId: "1:739243257292:web:2297646bb9296077088169",
    measurementId: "G-TE8JH9KR9G"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // --- GÄ°RÄ°Å / Ã‡IKIÅ ---
  window.login = () => {
    const e = document.getElementById('email').value;
    const p = document.getElementById('password').value;
    signInWithEmailAndPassword(auth, e, p).catch(err => alert("Hata: " + err.message));
  }
  window.logout = () => signOut(auth);

  onAuthStateChanged(auth, (user) => {
    if (user) {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-panel').style.display = 'grid';
      initApp();
    } else {
      document.getElementById('login-screen').style.display = 'flex';
      document.getElementById('admin-panel').style.display = 'none';
    }
  });

  function initApp() {
    loadSettings();
    subscribeCollection('duyurular', 'list-duyurular', (d) => `<b>${d.baslik}</b> <br> <small>${d.etiket}</small>`);
    subscribeCollection('etkinlikler', 'list-etkinlikler', (d) => `<b>${d.baslik}</b> <br> <small>${d.tarih} - ${d.konum}</small>`);
    subscribeCollection('galeri', 'list-galeri', (d) => `<b>${d.aciklama}</b> <br> <small>${d.url}</small>`);
    subscribeCollection('basvurular', 'list-basvurular', (d) => `<b>${d.ad} ${d.soyad}</b> <br> <small>${d.bolum} - ${d.email}</small>`);
  }

  // --- GENEL LÄ°STELEME VE SÄ°LME FONKSÄ°YONU ---
  function subscribeCollection(colName, divId, formatFn) {
    const q = query(collection(db, colName), orderBy("timestamp", "desc"));
    onSnapshot(q, (snap) => {
      const div = document.getElementById(divId);
      div.innerHTML = "";
      if(snap.empty) { div.innerHTML = "<small style='padding:20px; color:#666'>KayÄ±t bulunamadÄ±.</small>"; return; }
      
      snap.forEach(d => {
        const data = d.data();
        div.innerHTML += `
          <div class="data-item">
            <div class="data-info">${formatFn(data)}</div>
            <button class="btn-delete" onclick="deleteItem('${colName}', '${d.id}')">SÄ°L</button>
          </div>`;
      });
    });
  }

  window.deleteItem = async (col, id) => {
    if(confirm("Bu kaydÄ± kalÄ±cÄ± olarak silmek istiyor musunuz?")) {
      await deleteDoc(doc(db, col, id));
    }
  }

  // --- EKLEME Ä°ÅLEMLERÄ° ---
  window.addDuyuru = async () => {
    await addDoc(collection(db, "duyurular"), {
      baslik: document.getElementById('d-baslik').value,
      icerik: document.getElementById('d-icerik').value,
      etiket: document.getElementById('d-etiket').value,
      timestamp: new Date()
    });
    alert("Duyuru Eklendi!");
  }

  window.addEtkinlik = async () => {
    await addDoc(collection(db, "etkinlikler"), {
      baslik: document.getElementById('e-baslik').value,
      tarih: document.getElementById('e-tarih').value,
      konum: document.getElementById('e-konum').value,
      aciklama: document.getElementById('e-aciklama').value,
      timestamp: new Date()
    });
    alert("Etkinlik Eklendi!");
  }

  window.addGaleri = async () => {
    await addDoc(collection(db, "galeri"), {
      url: document.getElementById('g-url').value,
      aciklama: document.getElementById('g-desc').value,
      timestamp: new Date()
    });
    alert("FotoÄŸraf Eklendi!");
  }

  // --- SÄ°TE AYARLARI (ANA SAYFA YAZILARI) ---
  window.saveSettings = async () => {
    await setDoc(doc(db, "ayarlar", "homepage"), {
      heroTitle: document.getElementById('set-hero-title').value,
      heroSub: document.getElementById('set-hero-sub').value,
      aboutText: document.getElementById('set-about').value
    });
    alert("Ayarlar GÃ¼ncellendi!");
  }

  async function loadSettings() {
    const docSnap = await getDoc(doc(db, "ayarlar", "homepage"));
    if (docSnap.exists()) {
      const d = docSnap.data();
      document.getElementById('set-hero-title').value = d.heroTitle || "";
      document.getElementById('set-hero-sub').value = d.heroSub || "";
      document.getElementById('set-about').value = d.aboutText || "";
    }
  }

  // MenÃ¼ GeÃ§iÅŸi
  window.showSection = (id) => {
    document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
    document.getElementById('sec-' + id).classList.add('active');
    event.target.classList.add('active');
  }
</script>
</body>
</html>
