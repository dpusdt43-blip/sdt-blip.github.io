<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SDT | Genel Yönetim Merkezi</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Source+Serif+4:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root { --ink: #0e0e14; --gold: #c9a84c; --crimson: #8b1a2b; --parchment: #f5f0e8; --panel-bg: #121218; }
* { box-sizing: border-box; font-family: 'Source Serif 4', serif; }
body { background: var(--ink); color: var(--parchment); margin: 0; min-height: 100vh; }

/* GİRİŞ */
#login-screen { position: fixed; inset: 0; background: var(--ink); display: flex; align-items: center; justify-content: center; z-index: 999; }
.login-box { background: rgba(255,255,255,0.03); padding: 40px; border: 1px solid var(--gold); border-top: 4px solid var(--gold); width: 100%; max-width: 360px; text-align: center; }

/* PANEL */
#admin-panel { display: none; grid-template-columns: 240px 1fr; min-height: 100vh; }

/* SOL MENÜ */
.sidebar { background: #08080a; border-right: 1px solid #222; padding: 20px; display: flex; flex-direction: column; }
.brand { font-family: 'Playfair Display', serif; color: var(--gold); font-size: 20px; margin-bottom: 40px; }
.nav-btn { background: transparent; border: none; color: #888; text-align: left; padding: 12px 15px; margin-bottom: 5px; cursor: pointer; border-radius: 4px; font-size: 14px; }
.nav-btn:hover { background: rgba(255,255,255,0.05); color: var(--parchment); }
.nav-btn.active { background: rgba(201,168,76,0.15); color: var(--gold); border-left: 3px solid var(--gold); }
.logout-btn { margin-top: auto; background: #1a1a20; color: #aaa; border: 1px solid #333; }

/* İÇERİK */
.main-content { padding: 40px; overflow-y: auto; background: var(--panel-bg); }
.section-title { font-family: 'Playfair Display', serif; font-size: 28px; margin-bottom: 20px; color: var(--gold); border-bottom: 1px solid #333; padding-bottom: 15px; }
.content-section { display: none; }
.content-section.active { display: block; }

.card { background: rgba(255,255,255,0.02); border: 1px solid #2a2a35; padding: 25px; margin-bottom: 20px; border-radius: 4px; }
.form-group { margin-bottom: 15px; }
.form-group label { display: block; font-size: 11px; text-transform: uppercase; color: #666; margin-bottom: 8px; }
input, textarea { width: 100%; background: #1a1a20; border: 1px solid #333; color: var(--parchment); padding: 12px; border-radius: 4px; }

.btn-primary { background: var(--gold); color: var(--ink); border: none; padding: 12px 24px; font-weight: bold; cursor: pointer; border-radius: 2px; }

.data-list { display: grid; gap: 10px; margin-top: 20px; }
.data-item { background: rgba(255,255,255,0.03); padding: 15px; display: flex; justify-content: space-between; align-items: center; border-left: 3px solid var(--gold); }
.delete-btn { color: #ff4757; background: none; border: none; cursor: pointer; font-size: 12px; }

@media (max-width: 768px) {
#admin-panel { grid-template-columns: 1fr; }
.sidebar { display: none; }
}
</style>
</head>
<body>

<div id="login-screen">
  <div class="login-box">
    <div style="font-size:40px; color:var(--gold); margin-bottom:10px;">Σ</div>
    <h2>YÖNETİM PANELİ</h2>
    <input type="email" id="email" placeholder="E-Posta">
    <input type="password" id="password" placeholder="Şifre" style="margin-top:10px;">
    <button onclick="login()" class="btn-primary" style="width:100%; margin-top:20px;">GİRİŞ YAP</button>
  </div>
</div>

<div id="admin-panel">
  <aside class="sidebar">
    <div class="brand">Σ SDT Admin</div>
    <button class="nav-btn active" onclick="showSection('basvurular', this)">Başvurular</button>
    <button class="nav-btn" onclick="showSection('yonetim', this)">Yönetim</button>
    <button class="nav-btn" onclick="showSection('etkinlikler', this)">Etkinlikler</button>
    <button class="nav-btn" onclick="showSection('duyurular', this)">Duyurular</button>
    <button class="logout-btn nav-btn" onclick="logout()">Çıkış</button>
  </aside>

  <main class="main-content">
    <section id="sec-basvurular" class="content-section active">
      <h2 class="section-title">Başvurular</h2>
      <div id="basvuru-list" class="data-list"></div>
    </section>

    <section id="sec-yonetim" class="content-section">
      <h2 class="section-title">Yönetim</h2>
      <input type="text" id="y-ad" placeholder="Ad Soyad">
      <input type="text" id="y-gorev" placeholder="Görev" style="margin-top:10px;">
      <button class="btn-primary" onclick="addYonetim()" style="margin-top:10px;">Ekle</button>
      <div id="yonetim-list" class="data-list"></div>
    </section>

    <section id="sec-etkinlikler" class="content-section">
      <h2 class="section-title">Etkinlikler</h2>
      <input type="text" id="e-baslik" placeholder="Başlık">
      <input type="date" id="e-tarih" style="margin-top:10px;">
      <button class="btn-primary" onclick="addEtkinlik()" style="margin-top:10px;">Ekle</button>
      <div id="etkinlik-list" class="data-list"></div>
    </section>

    <section id="sec-duyurular" class="content-section">
      <h2 class="section-title">Duyurular</h2>
      <input type="text" id="d-baslik" placeholder="Başlık">
      <button class="btn-primary" onclick="addDuyuru()" style="margin-top:10px;">Ekle</button>
      <div id="duyuru-list" class="data-list"></div>
    </section>
  </main>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, collection, addDoc, deleteDoc, doc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

/* ✅ Firebase Config EKLENDİ */
const firebaseConfig = {
  apiKey: "AIzaSyDPLsa0Vstirz25FU4JAp5oUcTHJXcOM5I",
  authDomain: "siyasal-dusunceler-toplulugu.firebaseapp.com",
  projectId: "siyasal-dusunceler-toplulugu",
  storageBucket: "siyasal-dusunceler-toplulugu.firebasestorage.app",
  messagingSenderId: "739243257292",
  appId: "1:739243257292:web:2297646bb9296077088169",
  measurementId: "G-TE8JH9KR9G"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = () => {
  signInWithEmailAndPassword(auth, email.value, password.value)
    .catch(e => alert(e.message));
};
window.logout = () => signOut(auth);

onAuthStateChanged(auth, user => {
  if(user){
    login-screen.style.display="none";
    admin-panel.style.display="grid";
    init();
  } else {
    login-screen.style.display="flex";
    admin-panel.style.display="none";
  }
});

function init(){
  subscribe("yonetim","yonetim-list", d=>`${d.ad} - ${d.gorev}`);
  subscribe("etkinlikler","etkinlik-list", d=>`${d.baslik} - ${d.tarih}`);
  subscribe("duyurular","duyuru-list", d=>d.baslik);
}

function subscribe(col,div,format){
  const q=query(collection(db,col),orderBy("timestamp","desc"));
  onSnapshot(q,s=>{
    const el=document.getElementById(div);
    el.innerHTML="";
    s.forEach(docu=>{
      const d=docu.data();
      el.innerHTML+=`<div class="data-item">${format(d)}
      <button class="delete-btn" onclick="deleteItem('${col}','${docu.id}')">Sil</button></div>`;
    });
  });
}

window.addYonetim=()=>addDoc(collection(db,"yonetim"),{
  ad:y-ad.value,gorev:y-gorev.value,timestamp:new Date()
});
window.addEtkinlik=()=>addDoc(collection(db,"etkinlikler"),{
  baslik:e-baslik.value,tarih:e-tarih.value,timestamp:new Date()
});
window.addDuyuru=()=>addDoc(collection(db,"duyurular"),{
  baslik:d-baslik.value,timestamp:new Date()
});
window.deleteItem=(c,i)=>deleteDoc(doc(db,c,i));

window.showSection=(id,btn)=>{
  document.querySelectorAll(".content-section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll(".nav-btn").forEach(b=>b.classList.remove("active"));
  document.getElementById("sec-"+id).classList.add("active");
  btn.classList.add("active");
};
</script>

</body>
</html>
